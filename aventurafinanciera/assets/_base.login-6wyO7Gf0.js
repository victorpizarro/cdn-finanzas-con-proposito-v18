import{j as e}from"./jsx-runtime-DrDP4jKM.js";import{u as b,I as p}from"./index-ug3b5FL9.js";import{B as u}from"./Button-DxyI6BO3.js";import{A as w}from"./abstract-gray-loop-C8zS91ny.js";import{g as j}from"./auth-D2p3Ysfq.js";import{l as f,a as y}from"./utils-sBV5Xq2o.js";import{r as v}from"./index-DPzuYzxM.js";import{e as d}from"./environment-Mqz1F-Rt.js";import{t as N,i as x}from"./tw-merge-41n7K-40.js";import{c as A}from"./index-kqjhJLLg.js";import{d as P,g as _,F as I,f as g}from"./components-luAo7umQ.js";import{j as l,r as h}from"./responses-JPWar71Q.js";import{m as k,a as E,b as L}from"./chunk-II5OMS4Q-B6qxbQ_i.js";import"./index-CgQdyTPq.js";import"./import-KpIH9fyR.js";import"./_commonjsHelpers-C4iS2aBk.js";import"./util-DVlLIp8b.js";import"./import-C_SV6fS0.js";import"./router-JOb6U47x.js";import"./Combination-vy5DdgBQ.js";const R="https://aventurafinancierabackend.azurewebsites.net/aventurafinanciera/assets/kid-4-DgaGaNH6.png",Z=async({request:s})=>{const a=await s.formData(),t=a.get("login"),o=a.get("password"),i={email:t,password:o},r={email:t};try{const{user:n}=await y(i),c=new URL(s.url).searchParams.get("redirect");if(n)return c&&(c.startsWith("/")||c.startsWith("https://finanzasconproposito.edu.do"))?l({fields:r,redirectTo:c}):l({fields:r,redirectTo:d.basePath})}catch(n){return n instanceof Error?l({fields:r,error:n.message}):l({fields:r,error:"Ha ocurrido un error al iniciar sesión. Por favor, inténtalo de nuevo."})}return l({fields:r})},q=async({request:s})=>{const t=new URL(s.url).searchParams.get("redirect"),o=t===`${d.basePath}/download-book`;return j().loggedIn?t&&(t.startsWith("/")||t.startsWith("https://finanzasconproposito.edu.do"))?h(t):h(d.basePath):l({showImage:o})};function ee(){const s=A(),{showImage:a}=P(),{fields:t,redirectTo:o,error:i}=_()||{},[r,n]=b(!1);return v.useEffect(()=>{o&&s(o,{replace:!0,preventScrollReset:!0})},[o]),e.jsx(k,{isOpen:!0,onClose:()=>{var m;s("..",{preventScrollReset:!0,replace:!0}),(m=window.parent)==null||m.postMessage("book_downloaded","*")},placement:"center",className:N(`overflow-hidden bg-background ${a?"max-w-3xl":"max-w-xl"}`),children:e.jsx(E,{children:()=>e.jsxs(I,{method:"post",children:[e.jsxs(L,{className:"flex flex-col lg:flex-row",children:[a&&e.jsx("div",{className:"flex flex-1 justify-center",children:e.jsx("img",{className:"-mb-3 max-lg:w-1/2 max-lg:max-w-56 lg:absolute lg:bottom-0 lg:mb-0 lg:max-h-full lg:pt-14",src:R})}),e.jsxs("div",{className:"px-8 pb-16 lg:flex-1 lg:pt-16",children:[e.jsx("h1",{className:`font-title text-xl font-black text-primary lg:text-2xl ${a?"text-left":"text-center"}`,children:'Inicia sesión para acceder al cuento "Ahorrar es crear"'}),i&&e.jsx("span",{className:"text-center text-danger",children:i}),e.jsx(x,{name:"login",color:"secondary",label:"Correo electrónico",variant:"underlined",defaultValue:t==null?void 0:t.email,classNames:{inputWrapper:"border-b-small border-[#0A568E] hover:border-[#0A568E]",label:"text-[#889FBC] "}}),e.jsx(x,{name:"password",color:"secondary",label:"Contraseña",variant:"underlined",type:r?"text":"password",classNames:{inputWrapper:"border-b-small border-[#0A568E] hover:border-[#0A568E]",label:"text-[#889FBC]"},endContent:e.jsx(u,{isIconOnly:!0,variant:"light",className:"rounded-full text-xl",onPress:()=>n(),children:r?e.jsx(p,{icon:"mdi:eye-off",className:"text-secondary"}):e.jsx(p,{icon:"mdi:eye",className:"text-secondary"})})}),e.jsx(u,{variant:"solid",color:"primary",className:"mt-8 w-full",type:"submit",children:"Iniciar Sesión"}),e.jsxs("div",{className:"flex flex-col justify-between gap-4 pt-4 sm:flex-row",children:[e.jsx(f,{as:g,to:`${d.basePath}/signup`,color:"secondary",className:"text-start text-sm",preventScrollReset:!0,replace:!0,children:"¿No tienes cuenta?"}),e.jsx(f,{as:g,to:"https://finanzasconproposito.edu.do/web/reset_password?redirect=https://finanzasconproposito.edu.do/",color:"secondary",className:"text-end text-sm",children:"Restablecer contraseña"})]})]})]}),e.jsx(w,{className:"absolute -left-24 -top-[10%] -z-10 w-[125%] text-gray-200/20"})]})})})}export{Z as clientAction,q as clientLoader,ee as default};
